# Maven
## 可选依赖
在dependency标签中设置optional为true，即可对上隐藏该依赖，也即取消该依赖的传递性。
## 排除依赖
在dependency标签中设置exclusions，使得在导入该dependency时防止导入exclusion指定的包。
## 聚合
使用聚合可以让一个工程统一管理其他多个工程，让多个maven一起运作。父主动管理子。用于快速构建项目。

新建一个聚合模块，将其packaging设为pom（表明用于聚合或继承）。然后使用modules以路径的形式配置要管理的各个模块。

```xml
<modules>
    <module>../maven_02_ssm</module>
    <module>../maven_03_pojo</module>
    <module>../maven_04_dao</module>
</modules>
```

会自动按照依赖关系决定的顺序进行加载。
## 继承
使用parent定义父工程，从父工程中继承依赖，简化依赖配置与版本管理。子主动依附父。用于快速配置。

以此可以把项目通用的依赖都放在父工程中。

```xml
<parent>
	<groupId>com.exm</groupId>
	<artifactId>fid</artifactId>
	<version>1.6.1</version>
	<!--定位到pom-->
	<!--不配relativePath则会去本地库和中央库中去找依赖包-->
	<relativePath>../FatherFileName/pom.xml</relativePath>
</parent>
```

父工程也可以提供一些可选依赖,本质上是版本指定。子工程要用此依赖的话，在导入的时候不指定版本，默认使用父工程选择的版本。子工程也会继承dependencyManagement的设定。

```xml
<!--父工程-->
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>druid</artifactId>
            <version>1.1.16</version>
        </dependency>
    </dependencies>
</dependencyManagement>
```

```xml
<!--子工程-->
<dependencies>
    <dependency>
        <groupId>com.alibaba</groupId>
        <artifactId>druid</artifactId>
    </dependency>
</dependencies>
```

## 属性
使用properties标签定义几个属性，可以在其他地方通过`${xxx}`的形式引用。

```xml
<properties> 
	<spring.framework>4.0.4.RELEASE</spring.framework> 
</properties>
```

`${project.basedir}`是一个内置属性，它能同时成为所有模块的根路径，可用于快速匹配存在于某一个模块中的某资源。

使用`mvn help:system`可以查看环境变量属性和Java系统属性。

# SpringBoot
## 杂项
Application会扫描它所在的包及其子包。

测试类使用`@SpringBootTest`注解，并且application测试类应当和被测试的application放在同一个包路径下（否则要向注解中传入被测试类的class作为参数）以读取application中的配置。

如果要修改SpringBoot提供的依赖（如把tomcat换成其他服务器），则可以用exclusion去掉原依赖，然后导入对应依赖（也应当用SpringBoot提供的依赖）。
## 配置文件
一般使用yml后缀。读取顺序：`yaml`->`yml`->`properties`。因此`properties`优先级最高。

## 多环境
### 配置方式
配置`spring.profiles.active`的值即可。

```yml
spring:
	profiles:
		active: dev
```

之后可以使用`---`划分配置文件并使用`spring.config.activate.on-profile`来定义对应环境；也可以分多个文件进行配置（文件名后面加环境名，如`application-dev.yml`）。
### 通过Maven配置
应当使用maven的参数来控制环境的选择。

加入`maven-resource-plugin`插件即可让配置文件通过`${xxx}`获得maven中定义的参数，从而可以通过maven控制yml中`profiles.active`的值。

```xml
<!--引入插件-->
<plugin>
	<groupId>org.apache.maven.plugins</groupId>
	<artifactId>maven-resources-plugin</artifactId>
	<version>3.2.0</version>
	<configuration>
		<encoding>UTF-8</encoding>
		<useDefaultDelimiters>true</useDefaultDelimiters>
	</configuration>
</plugin>
```

```xml
<!--定义属性并指定默认值-->
<profile>
	<id>dev_env</id>
	<properties>
		<profile.active>dev</profile.active>
	</properties>
	<activation>
		<activeByDefault>true</activeByDefault>
	</activation>
</profile>
```

### 外部配置
在jar包同目录下写`application.yml`即可进行覆盖配置，优先级更高。

为上线服务，灵活配置。

## 整合Mybatis
Mybatis观察dao的返回值以辨别实体类。

使用`@Mapper`注解来定义dao类，使得Mybatis得以管理它。

```yml
spring:
	datasource:
		#高版本无需设时区
		url: jdbc:mysql://localhost:3306/ssm_db?serverTimezone=UTC
		username: root
		password: 1234
		driver-class-name: com.mysql.jdbc.Driver
		#使用Druid连接池
		type: com.alibaba.druid.pool.DruidDataSource
```

```yml
mybatis-plus:
	#开启驼峰功能，保证实体类属性正确映射数据表属性
	configuration:
	    map-underscore-to-camel-case: true
	#为未赋值的主键自动添加uuid
	global-config:
		db-config:
			id-type: uuid
```